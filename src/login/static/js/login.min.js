function getCookie(e){var t=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var i=jQuery.trim(o[n]);if(i.substring(0,e.length+1)==e+"="){t=decodeURIComponent(i.substring(e.length+1));break}}return t}function refresh_token(){var e=getCookie("bklogin_csrftoken");return $('input[name="csrfmiddlewaretoken"]').val(e),!0}$(document).ready(function(){function e(){setTimeout(function(){s.html("").hide()},200)}$(".language-switcher img").click(function(){$(this).toggleClass("en");var e="zh-hans";$(this).hasClass("en")&&(e="en"),$("#language-form select").val(e),setTimeout(function(){$("#language-form").submit()},500)}),$(".action .protocol-btn").click(function(e){$(".protocol-pop").show()}),$(".protocol-pop .close").click(function(e){$(".protocol-pop").hide()}),$(".consent-content .consent-btn").click(function(){$(".protocol-pop").hide()}),$("#close-chrome").click(function(){$(".is-chrome").hide()}),$("#close-certificate").click(function(){$(".is-certificate").hide()});var t="0"!=$(".is-certificate").attr("data-ok");t||($(".is-certificate").show(),$(".form-login").addClass("certificate-expired"),$(".form-login").find(".group-control input").attr("disabled","disabled"),$(".btn-content").find(".login-btn").attr("disabled","disabled")),null==navigator.userAgent.toLowerCase().match(/chrome/)&&t?$(".is-chrome").show():$(".is-chrome").hide();var o=[],n=$("#domains").val();""!=n&&(o=n.split(";"));var s=$("#user-domain-list"),c=!1;$("#login-form").on("submit",function(e){return refresh_token(),!c}),$("#login-btn").on("click",function(){$("#login-form").submit()}),$(document).on("click",function(){e()}),s.on("click",function(e){return!1}),s.on("click","li",function(t){var o=$(t.target);return $("#user").val(o.text()),$("#password").focus(),e(),!1}),$("#password").on("keyup",function(e){13===e.keyCode&&$("#login-form").submit()}),$("#user").on("keyup",function(t){switch(t.keyCode){case 38:var n=s.find(".selected");if(n.length){n.removeClass("selected");var l=n.prev();l.length&&l.addClass("selected")}else s.find("li:last").addClass("selected");break;case 40:var n=s.find(".selected");if(n.length){n.removeClass("selected");var r=n.next();r.length&&r.addClass("selected")}else s.find("li:first").addClass("selected");break;case 13:var n=s.find(".selected");n.length?($("#user").val(n.text()),c=!0,setTimeout(function(){c=!1},200),$("#password").focus(),e()):$("#login-form").submit();break;default:var a=t.target.value,d=a.split("@")[0];if(d.length>=2&&a.indexOf("@")>-1){var u=a.split("@")[1],f="";for(i=0;i<o.length;i++)if(o[i].indexOf(u)>-1){var g="<li><strong>"+d+"</strong>@"+o[i]+"</li>";f+=g}s.html(f).show()}else s.hide()}})});
